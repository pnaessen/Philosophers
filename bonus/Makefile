NAME := philo_bonus

SRC:= $(addprefix $(SRC_DIR), philo_bonus.c init_bonus.c routine_bonus.c monitor_bonus.c actions_bonus.c  utils_bonus.c tools_bonus.c)
OBJ_DIR:= .obj/
OBJ:= $(SRC:$(SRC_DIR)%.c=$(OBJ_DIR)%.o)
DEPS:= $(OBJ:%.o=%.d)

CC:= cc
CCFLAGS:= -Wextra -Wall -Werror -pthread
CPPFLAGS = -MMD -MP
SRC_DIR:= src/
INCLUDES:= include/

HEADERS:= -I $(INCLUDES) 

all: welcome $(NAME)

$(NAME):  $(OBJ) 
	$(CC) $(CCFLAGS) $(OBJ) -o $(NAME)
	@echo "$(GREEN)¬´ Le paradoxe du philosophe : il meurt de faim entour√© de spaghettis. ¬ª $(BLUE)$(CC) $(CCFLAGS) $(OBJ) -o $(NAME)$(DEF_COLOR)"
	@echo "$(GREEN)¬´ Les processus ont atteint l'√©tat de nirvana avec $(NAME). ¬ª - Bouddha (peut-√™tre) $(DEF_COLOR)"

$(OBJ_DIR)%.o: $(SRC_DIR)%.c
	@mkdir -p $(OBJ_DIR)
	@echo "$(MAGENTA)‚öíÔ∏è ¬´ La s√©maphore est la cl√© de la synchronisation. ¬ª - Alan Turing, en compilant $< $(DEF_COLOR)"
	$(CC) $(CCFLAGS) $(CPPFLAGS) $(HEADERS) -o $@ -c $<


# Colors

DEF_COLOR = \033[0;39m
GRAY = \033[0;90m
RED = \033[0;91m
GREEN = \033[0;92m
YELLOW = \033[0;93m
BLUE = \033[0;94m
MAGENTA = \033[0;95m
CYAN = \033[0;96m
WHITE = \033[0;97m

welcome:
	@echo "$(CYAN)üí≠ü§î ¬´ Les processus sont comme les pens√©es: parfois ils se bloquent ! ¬ª Compilation de $(NAME)...  ! $(DEF_COLOR)"

clean:
	@echo "üßπ $(YELLOW)¬´ Nettoyer le code, c'est nettoyer l'esprit. ¬ª - Platon$(DEF_COLOR)"
	@echo "üßπ $(YELLOW)¬´ La suppression est parfois un acte de cr√©ation. ¬ª - Socrate $(DEF_COLOR)"
	rm -rf $(OBJ_DIR)

fclean: clean
	@echo "$(RED)"
	@echo "        üíÄ"
	@echo "       (X_X)"
	@echo "      / | | \\"
	@echo "       /   \\"
	@echo "  ¬´ Pour obtenir le savoir, il faut d'abord tout d√©truire. ¬ª - Zeno"
	@echo "$(DEF_COLOR)"
	@echo "$(RED)üß®üí• ¬´ Un processus sans but est un processus mort ! ¬ª - Jean-Paul SIGTERM üí•üß® $(DEF_COLOR)"
	rm -f $(NAME)


re: fclean all
	@echo "$(CYAN)¬´ fork() cr√©e, waitpid() patiente, kill() d√©truit, tel est le cycle de la vie. ¬ª - Spinoza $(DEF_COLOR)"

info:
	@echo "OBJ": $(OBJ)
	@echo "DEPS": $(DEPS)
	@echo "$(GREEN)üí° ¬´ La connaissance du code est la premi√®re √©tape vers la sagesse. ¬ª - Aristote $(DEF_COLOR)"

-include $(DEPS)

.PHONY: all clean fclean re welcome info